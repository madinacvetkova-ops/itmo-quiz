<!DOCTYPE html>
<html lang="ru">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>–¢—ã ‚Äî —Å—Ç—É–¥–µ–Ω—Ç –ö–¢–£ | –ò–¢–ú–û</title>

<style>
:root { --itmo-blue:#0039A6; }

body {
  margin:0;
  font-family:Arial, sans-serif;
  background:#fff;
  color:#000;
}

.wrapper {
  max-width:1100px;
  margin:auto;
  text-align:center;
}

.screen { display:none; padding:20px; }
.screen.active { display:block; }

h1,h2 { color:var(--itmo-blue); }

button {
  padding:12px 18px;
  margin:8px;
  border:2px solid var(--itmo-blue);
  background:#fff;
  color:var(--itmo-blue);
  font-size:16px;
}

button:active {
  background:var(--itmo-blue);
  color:#fff;
}

canvas {
  border:1px solid #ccc;
  margin:10px auto;
  display:block;
}

input[type=range] { width:200px; }
</style>
</head>

<body>
<div class="wrapper">

<!-- START -->
<div class="screen active">
<h1>–¢—ã ‚Äî –∏–Ω–∂–µ–Ω–µ—Ä –ö–¢–£?</h1>
<p><b>–ú–µ–≥–∞—Ñ–∞–∫—É–ª—å—Ç–µ—Ç –ö–æ–º–ø—å—é—Ç–µ—Ä–Ω—ã—Ö —Ç–µ—Ö–Ω–æ–ª–æ–≥–∏–π –∏ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è</b><br>
–§–∞–∫—É–ª—å—Ç–µ—Ç —Å–∏—Å—Ç–µ–º —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –∏ —Ä–æ–±–æ—Ç–æ—Ç–µ—Ö–Ω–∏–∫–∏</p>
<button onclick="next()">–ù–∞—á–∞—Ç—å</button>
</div>

<!-- BASIC 1 -->
<div class="screen">
<h2>ü§ñ –ò–ò –∏–ª–∏ —á–µ–ª–æ–≤–µ–∫?</h2>
<p>¬´–ö–æ—à–∫–∞ –ø—Ä—ã–≥–∞–µ—Ç –≤ –∑–∞–∫–∞—Ç–µ, –∫–∞–∫ –ø–æ—Ç–æ–∫ –≤ –º–Ω–æ–≥–æ–ø–æ—Ç–æ—á–Ω–æ—Å—Ç–∏¬ª</p>
<button onclick="next()">–ò–ò</button>
<button onclick="next()">–ß–µ–ª–æ–≤–µ–∫</button>
</div>

<!-- BASIC 2 -->
<div class="screen">
<h2>üß≠ –ù–∞–π–¥–∏ –æ–ø—Ç–∏–º–∞–ª—å–Ω—ã–π –ø—É—Ç—å</h2>
<p>–ö–∞–∫–æ–π –º–∞—Ä—à—Ä—É—Ç –∫–æ—Ä–æ—á–µ –¥–ª—è —Ä–æ–±–æ—Ç–∞?</p>
<button onclick="next()">–í–∞—Ä–∏–∞–Ω—Ç A</button>
<button onclick="next()">–í–∞—Ä–∏–∞–Ω—Ç B</button>
</div>

<!-- BASIC 3 -->
<div class="screen">
<h2>‚öôÔ∏è –õ–æ–≥–∏–∫–∞ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è</h2>
<p>–ï—Å–ª–∏ –¥–∞—Ç—á–∏–∫ –≤–∏–¥–∏—Ç –ø—Ä–µ–ø—è—Ç—Å—Ç–≤–∏–µ ‚Äî —á—Ç–æ –¥–æ–ª–∂–µ–Ω —Å–¥–µ–ª–∞—Ç—å —Ä–æ–±–æ—Ç?</p>
<button onclick="next()">–û—Å—Ç–∞–Ω–æ–≤–∏—Ç—å—Å—è</button>
<button onclick="next()">–£—Å–∫–æ—Ä–∏—Ç—å—Å—è</button>
</div>

<!-- BASIC END -->
<div class="screen">
<h2>üéì –¢—ã –ø—Ä–æ—à—ë–ª BASIC!</h2>
<p>–•–æ—á–µ—à—å —É–≤–∏–¥–µ—Ç—å —Ä–µ–∞–ª—å–Ω—ã–µ –∑–∞–¥–∞—á–∏ —Å—Ç—É–¥–µ–Ω—Ç–æ–≤ –ö–¢–£?</p>
<button onclick="next()">üî• Advanced</button>
</div>

<!-- ADVANCED 1 -->
<div class="screen">
<h2>üß≠ BFS vs A*</h2>
<canvas id="grid" width="360" height="360"></canvas>
<button onclick="runBFS()">BFS</button>
<button onclick="runAStar()">A*</button>
<button onclick="next()">–î–∞–ª–µ–µ</button>
</div>

<!-- ADVANCED 2 -->
<div class="screen">
<h2>üì° –§–∏–ª—å—Ç—Ä–∞—Ü–∏—è —Å–∏–≥–Ω–∞–ª–∞</h2>
<canvas id="signal" width="600" height="220"></canvas>
<button onclick="rawSignal()">–ë–µ–∑ —Ñ–∏–ª—å—Ç—Ä–∞</button>
<button onclick="avgSignal()">–°—Ä–µ–¥–Ω–µ–µ</button>
<button onclick="medSignal()">–ú–µ–¥–∏–∞–Ω–Ω—ã–π</button>
<button onclick="next()">–î–∞–ª–µ–µ</button>
</div>

<!-- ADVANCED 3 PID -->
<div class="screen">
<h2>üß† PID-—Ä–µ–≥—É–ª—è—Ç–æ—Ä</h2>
<p>–ù–∞—Å—Ç—Ä–æ–π —Ä–µ–≥—É–ª—è—Ç–æ—Ä, —á—Ç–æ–±—ã —Å—Ç–∞–±–∏–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å —Å–∏—Å—Ç–µ–º—É</p>

P <input type="range" min="0" max="2" step="0.1" id="p"><br>
I <input type="range" min="0" max="1" step="0.05" id="i"><br>
D <input type="range" min="0" max="1" step="0.05" id="d"><br>

<canvas id="pid" width="600" height="220"></canvas>
<button onclick="startPID()">–ó–∞–ø—É—Å—Ç–∏—Ç—å</button>
<button onclick="next()">–§–∏–Ω–∞–ª</button>
</div>

<!-- FINAL -->
<div class="screen">
<h1>üéì –¢—ã ‚Äî —Å—Ç—É–¥–µ–Ω—Ç –ö–¢–£</h1>
<p>–¢–∞–∫ –≤—ã–≥–ª—è–¥—è—Ç —Ä–µ–∞–ª—å–Ω—ã–µ –∑–∞–¥–∞—á–∏ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è, –∞–ª–≥–æ—Ä–∏—Ç–º–æ–≤ –∏ —Ä–æ–±–æ—Ç–æ—Ç–µ—Ö–Ω–∏–∫–∏</p>
</div>

</div>

<script>
let step = 0;
const screens = document.querySelectorAll(".screen");

function next(){
  screens[step].classList.remove("active");
  step++;
  screens[step].classList.add("active");
}

/* ===== BFS / A* ===== */
const g = document.getElementById("grid").getContext("2d");
const size=8, cell=45;
const start={x:0,y:7}, goal={x:7,y:0};

function drawGrid(v=[]){
  g.clearRect(0,0,360,360);
  for(let y=0;y<size;y++)
    for(let x=0;x<size;x++)
      g.strokeRect(x*cell,y*cell,cell,cell);
  v.forEach(p=>{
    g.fillStyle="#aac";
    g.fillRect(p.x*cell,p.y*cell,cell,cell);
  });
  g.fillStyle="green";
  g.fillRect(start.x*cell,start.y*cell,cell,cell);
  g.fillStyle="red";
  g.fillRect(goal.x*cell,goal.y*cell,cell,cell);
}
drawGrid();

function runBFS(){
  let q=[start];
  let visited=[];
  let seen={};
  let parent={};
  seen[start.x+","+start.y]=true;

  let t=setInterval(()=>{
    if(!q.length){clearInterval(t);return;}

    let v=q.shift();
    visited.push(v);
    drawGrid(visited);

    if(v.x===goal.x && v.y===goal.y){
      clearInterval(t);
      drawPath(parent);
      return;
    }

    [[1,0],[-1,0],[0,1],[0,-1]].forEach(d=>{
      let nx=v.x+d[0], ny=v.y+d[1];
      let key=nx+","+ny;
      if(nx>=0&&ny>=0&&nx<size&&ny<size&&!seen[key]){
        seen[key]=true;
        parent[key]=v;
        q.push({x:nx,y:ny});
      }
    });
  },100);
}

function runAStar(){
  let open=[start];
  let visited=[];
  let seen={};
  let parent={};
  seen[start.x+","+start.y]=true;

  let t=setInterval(()=>{
    if(!open.length){clearInterval(t);return;}

    open.sort((a,b)=>
      Math.abs(a.x-goal.x)+Math.abs(a.y-goal.y) -
      (Math.abs(b.x-goal.x)+Math.abs(b.y-goal.y))
    );

    let v=open.shift();
    visited.push(v);
    drawGrid(visited);

    if(v.x===goal.x && v.y===goal.y){
      clearInterval(t);
      drawPath(parent);
      return;
    }

    [[1,0],[-1,0],[0,1],[0,-1]].forEach(d=>{
      let nx=v.x+d[0], ny=v.y+d[1];
      let key=nx+","+ny;
      if(nx>=0&&ny>=0&&nx<size&&ny<size&&!seen[key]){
        seen[key]=true;
        parent[key]=v;
        open.push({x:nx,y:ny});
      }
    });
  },100);
}


/* ===== SIGNAL ===== */
const s=document.getElementById("signal").getContext("2d");
let raw=Array.from({length:100},(_,i)=>120+30*Math.sin(i/8)+Math.random()*40);

function drawSig(data){
  s.clearRect(0,0,600,220);
  s.beginPath();
  data.forEach((v,i)=>s.lineTo(i*6,220-v));
  s.stroke();
}
function rawSignal(){ drawSig(raw); }
function avgSignal(){
  drawSig(raw.map((_,i)=>{
    let a=raw.slice(Math.max(0,i-3),i+4);
    return a.reduce((x,y)=>x+y)/a.length;
  }));
}
function medSignal(){
  drawSig(raw.map((_,i)=>{
    let a=raw.slice(Math.max(0,i-3),i+4).sort((a,b)=>a-b);
    return a[Math.floor(a.length/2)];
  }));
}
rawSignal();

/* ===== PID ===== */
const c=document.getElementById("pid").getContext("2d");

function startPID(){
  let P=+p.value, I=+i.value, D=+d.value;

  let y=0, target=110, sum=0, prev=0;
  let data=[];
  let maxY=0;
  let t=setInterval(()=>{
    let err=target-y;
    sum+=err;
    let diff=err-prev;
    let u=P*err + I*sum + D*diff;

    y+=u*0.1;
    prev=err;
    data.push(y);
    maxY=Math.max(maxY,y);

    c.clearRect(0,0,600,220);

    /* —Ü–µ–ª—å */
    c.strokeStyle="#aaa";
    c.beginPath();
    c.moveTo(0,220-target);
    c.lineTo(600,220-target);
    c.stroke();

    /* –≥—Ä–∞—Ñ–∏–∫ */
    c.strokeStyle="#000";
    c.beginPath();
    data.forEach((v,i)=>c.lineTo(i*6,220-v));
    c.stroke();

    /* –ø–æ–¥–ø–∏—Å–∏ */
    c.fillStyle="#000";
    c.font="14px Arial";

    if(maxY > target*1.3){
      c.fillText("‚ùå –ü–µ—Ä–µ—Ä–µ–≥—É–ª–∏—Ä–æ–≤–∞–Ω–∏–µ", 10, 20);
    } else if(Math.abs(err) > 30){
      c.fillText("‚ö†Ô∏è –ö–æ–ª–µ–±–∞–Ω–∏—è", 10, 20);
    } else if(data.length > 40){
      c.fillText("‚úÖ –°—Ç–∞–±–∏–ª–∏–∑–∞—Ü–∏—è", 10, 20);
    }

    if(data.length>100) clearInterval(t);
  },50);
}
